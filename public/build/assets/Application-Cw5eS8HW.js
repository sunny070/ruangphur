import{Q as B,d as ne}from"./dayjs.min-B5axMs0t.js";import{r as C,e as N,o as de,a as u,f,g as d,i,t as r,d as x,b as l,c as w,j as H,F as Y,h as n,n as y,Q as c,k as A,l as oe,N as Q,v as re,y as ue,A as ae}from"./app-DGLM-g85.js";import{Q as V}from"./QTooltip-arDLPPeg.js";import{Q as ie}from"./QSelect-BGOAOszc.js";import{Q as T,a as q}from"./format-DzI8yonQ.js";import{Q as ce}from"./QLayout-BaQxdw5U.js";import{Q as me}from"./QMenu-nYMXc-S9.js";import{Q as fe}from"./QPage-D6NK3abj.js";import{_ as ve}from"./AdminLayout-B9nLlYqr.js";import"./QChip-BrqkebyT.js";import"./rtl-DFPa-2ov.js";import"./QExpansionItem-DT2TqZwa.js";import"./ClosePopup-DLKAVyim.js";const be={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4"},ge={class:"text-lg sm:text-base font-black"},Ce={class:"text-xs sm:text-sm"},xe={class:"q-my-md grid grid-cols-1 md:grid-cols-2 gap-4"},ye={class:"q-my-md flex gap-16"},Ae={class:"flex justify-end"},he={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ke={key:0,class:"flex"},we={class:"flex justify-end pr-16"},Se={class:"table-responsive"},je={class:"q-table q-table__grid q-mb-lg"},Fe=["value"],Ie={class:"no-print"},$e=Object.assign({layout:ve},{__name:"Application",props:{applications:Array,statusCounts:Object,flash:Object},setup(h){const a=h,b=C(null),E=C([]),g=C(""),m=C("All"),o=C([]),P=C(!1),K=s=>ne(s).format("dddd, MMMM D, YYYY h:mm A"),G=N(()=>o.value.length>0),S=N(()=>o.value.some(s=>{const t=a.applications.find(e=>e.id===s);return(t==null?void 0:t.status)==="Pending"})),W=()=>{o.value.length===k.value.length?(o.value=[],P.value=!1):(o.value=k.value.map(s=>s.id),P.value=!0)},J=()=>{b.value?k.value=a.applications.filter(s=>s.deceased.district.name===b.value):k.value=a.applications};de(()=>{const s=[...new Set(a.applications.map(t=>t.deceased.district.name))];E.value=s.map(t=>({label:t,value:t}))});const k=N(()=>{let s=a.applications;if(b.value&&(s=s.filter(t=>t.deceased.district.name===b.value)),m.value==="Incoming"?s=s.filter(t=>t.status==="Pending"):m.value==="Verified"?s=s.filter(t=>t.status==="Verified"):m.value==="Rejected"&&(s=s.filter(t=>t.status==="Rejected")),g.value){const t=g.value.toLowerCase();s=s.filter(e=>e.application_no.toString().toLowerCase().includes(t)||e.applicant.name.toLowerCase().includes(t)||e.deceased.name.toLowerCase().includes(t)||e.applicant.mobile.toString().includes(t)||e.deceased.district.name.toLowerCase().includes(t))}return s}),j=s=>{m.value=s},X=async()=>{const s=o.value.filter(t=>{const e=a.applications.find(v=>v.id===t);return(e==null?void 0:e.status)==="Pending"});s.length!==0&&await Q.post("/verifier/applications/verify-all",{ids:s})},Z=async()=>{if(o.value.length>0)try{await Q.post("/verifier/applications/reject-all",{ids:o.value},{onSuccess:()=>{o.value=[]}})}catch(s){console.error("Error rejecting applications:",s)}},p=s=>{Q.get(route("verifier.applications.show",s))},ee=s=>{console.log("Edit application:",s)},te=s=>{console.log("Delete application:",s)},le=()=>{const t=document.querySelector(".q-table").cloneNode(!0);t.querySelectorAll(".no-print").forEach(F=>F.remove());const v=window.open("","","width=800,height=600");v.document.write(`
        <html>
            <head>
                <title>Print Table</title>
                <style>
                    table {
                        width: 100%;
                        border-collapse: collapse;
                    }
                    th, td {
                        padding: 8px 12px;
                        text-align: left;
                        border-bottom: 1px solid #ddd;
                    }
                    th {
                        background-color: #3A424A;
                        color: white;
                        font-weight: bold;
                    }
                </style>
            </head>
            <body>
                ${t.outerHTML}
            </body>
        </html>
    `),v.document.close(),v.print()},se=N(()=>[{label:"Incoming",count:a.statusCounts.Incoming||0,bgClass:"bg-[#FFF7EF]",textClass:"text-[#FD7900]"},{label:"Verified",count:a.statusCounts.Verified||0,bgClass:"bg-[#EEFFF8]",textClass:"text-[#00AA68]"},{label:"Rejected",count:a.statusCounts.Rejected||0,bgClass:"bg-[#FFF2F2]",textClass:"text-[#FE6262]"},{label:"Pending",count:a.statusCounts.Pending||0,bgClass:"bg-[#F2F8FF]",textClass:"text-[#404CF1]"}]);return(s,t)=>(u(),f(fe,{padding:""},{default:d(()=>[h.flash.success?(u(),f(B,{key:0,class:"bg-green-4 text-white",dense:""},{default:d(()=>[i(r(h.flash.success),1)]),_:1})):x("",!0),h.flash.error?(u(),f(B,{key:1,class:"bg-red-4 text-white",dense:""},{default:d(()=>[i(r(h.flash.error),1)]),_:1})):x("",!0),l("div",be,[(u(!0),w(Y,null,H(se.value,e=>(u(),w("div",{key:e.label,class:y(`w-full h-[78px] ${e.bgClass} ${e.textClass} p-4`)},[l("h6",ge,r(e.count),1),l("p",Ce,r(e.label),1)],2))),128))]),l("div",xe,[l("div",ye,[n(c,{label:"All",flat:"",class:y(m.value==="All"?"active-button":"inactive-button"),onClick:t[0]||(t[0]=e=>j("All"))},null,8,["class"]),n(c,{label:"Incoming",flat:"",class:y(m.value==="Incoming"?"active-button":"inactive-button"),onClick:t[1]||(t[1]=e=>j("Incoming"))},null,8,["class"]),n(c,{label:"Verified",flat:"",class:y(m.value==="Verified"?"active-button":"inactive-button"),onClick:t[2]||(t[2]=e=>j("Verified"))},null,8,["class"]),n(c,{label:"Rejected",flat:"",class:y(m.value==="Rejected"?"active-button":"inactive-button"),onClick:t[3]||(t[3]=e=>j("Rejected"))},null,8,["class"])]),l("div",Ae,[n(oe,{rounded:"lg",outlined:"",dense:"","bottom-slots":"",modelValue:g.value,"onUpdate:modelValue":t[5]||(t[5]=e=>g.value=e),label:"Search",color:"black",class:"w-full max-w-md"},{append:d(()=>[g.value!==""?(u(),f(A,{key:0,name:"close",onClick:t[4]||(t[4]=e=>g.value=""),class:"cursor-pointer"})):x("",!0),n(A,{name:"search"})]),_:1},8,["modelValue"])])]),l("div",he,[l("div",null,[G.value?(u(),w("div",ke,[n(c,{style:{"border-radius":"8px"},size:"md",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:W},{default:d(()=>[n(A,{name:"check",size:"16px",class:"q-mr-xs"}),t[8]||(t[8]=l("span",null,"Select All",-1))]),_:1}),n(c,{style:{"border-radius":"8px"},size:"md",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:X,disabled:!o.value.length||!S.value},{default:d(()=>[n(A,{name:"check_circle",size:"16px",class:"q-mr-xs"}),t[11]||(t[11]=l("span",null,"Verify All",-1)),!S.value&&o.value.length?(u(),f(V,{key:0},{default:d(()=>t[9]||(t[9]=[i(" Cannot verify - selected applications are already processed ")])),_:1})):o.value.length?x("",!0):(u(),f(V,{key:1},{default:d(()=>t[10]||(t[10]=[i(" Select applications to verify ")])),_:1}))]),_:1},8,["disabled"]),n(c,{style:{"border-radius":"8px"},size:"md",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:Z,disabled:!o.value.length||!S.value},{default:d(()=>[n(A,{name:"cancel",size:"16px",class:"q-mr-xs"}),t[14]||(t[14]=l("span",null,"Reject All",-1)),!S.value&&o.value.length?(u(),f(V,{key:0},{default:d(()=>t[12]||(t[12]=[i(" Cannot Reject - selected applications are already processed ")])),_:1})):o.value.length?x("",!0):(u(),f(V,{key:1},{default:d(()=>t[13]||(t[13]=[i(" Select applications to verify ")])),_:1}))]),_:1},8,["disabled"])])):x("",!0)]),l("div",we,[n(c,{size:"sm",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:le},{default:d(()=>[n(A,{name:"print",size:"16px",class:"q-mr-xs"}),t[15]||(t[15]=l("span",null,"Print",-1))]),_:1}),n(ie,{color:"dark",style:{color:"#000",width:"128px",height:"40px","flex-shrink":"0","border-radius":"8px",border:"1px solid black",background:"transparent"},modelValue:b.value,"onUpdate:modelValue":t[6]||(t[6]=e=>b.value=e),options:E.value,label:"Select District",outlined:"",dense:"",class:"q-mb-md",onInput:J},null,8,["modelValue","options"])])]),l("div",Se,[l("table",je,[t[20]||(t[20]=l("thead",{class:"bg-[#3A424A] text-white font-bold h-[30px] w-full text-[11px]"},[l("tr",null,[l("th",{class:"no_print"}),l("th",null,"Sl.No."),l("th",null,"APPLICATION NO."),l("th",null,"APPLICANT NAME"),l("th",null,"ADDRESS"),l("th",null,"CONTACT No."),l("th",null,"MITTHI KHUA"),l("th",null,"PLACE OF DEATH"),l("th",null,"KILOMETER"),l("th",null,"AMOUNT CLAIMED"),l("th",null,"ACCOUNT No. OF CLAIMANT"),l("th",null,"IFSC"),l("th",null,"STATUS"),l("th",null,"DIL NI"),l("th",{class:"no-print"},"ACTIONS"),l("th",{class:"print-only"},"SIGNATURE")])],-1)),l("tbody",null,[(u(!0),w(Y,null,H(k.value,(e,v)=>{var F,_,D,L,M,O,R,$,z,U;return u(),w("tr",{key:e.id},[l("td",null,[re(l("input",{class:"no-print",type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=I=>o.value=I),value:e.id},null,8,Fe),[[ue,o.value]])]),l("td",null,r(v+1),1),l("td",null,r(e==null?void 0:e.application_no),1),l("td",null,r((F=e==null?void 0:e.applicant)==null?void 0:F.name),1),l("td",null,r((_=e==null?void 0:e.applicant)==null?void 0:_.locality),1),l("td",null,r((D=e==null?void 0:e.applicant)==null?void 0:D.mobile),1),l("td",null,r((M=(L=e==null?void 0:e.deceased)==null?void 0:L.district)==null?void 0:M.name),1),l("td",null,r((O=e==null?void 0:e.deceased)==null?void 0:O.place_of_death),1),l("td",null,r((R=e==null?void 0:e.transport)==null?void 0:R.distance),1),l("td",null,r(($=e==null?void 0:e.transport)==null?void 0:$.transport_cost),1),l("td",null,r((z=e==null?void 0:e.applicant)==null?void 0:z.account_no),1),l("td",null,r((U=e==null?void 0:e.applicant)==null?void 0:U.ifsc_code),1),l("td",null,[l("div",{class:y([{"status-incoming":(e==null?void 0:e.status)==="Pending","status-rejected":(e==null?void 0:e.status)==="Rejected","status-approved":(e==null?void 0:e.status)==="Verified"},"status-badge"])},r(e==null?void 0:e.status),3)]),l("td",null,r(K(e==null?void 0:e.created_at)),1),l("td",Ie,[n(c,{flat:"",icon:"more_vert",style:ae(s.buttonStyle)},null,8,["style"]),n(me,null,{default:d(()=>[n(ce,null,{default:d(()=>[n(T,{clickable:"",class:"action-btn",onClick:I=>p(e.id)},{default:d(()=>[n(q,null,{default:d(()=>t[16]||(t[16]=[i("View")])),_:1})]),_:2},1032,["onClick"]),n(T,{class:"action-btn",onClick:I=>ee(e.id)},{default:d(()=>[n(q,null,{default:d(()=>t[17]||(t[17]=[i("Edit/Update")])),_:1})]),_:2},1032,["onClick"]),n(T,{class:"action-btn",onClick:I=>te(e.id)},{default:d(()=>[n(q,null,{default:d(()=>t[18]||(t[18]=[i("Delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),t[19]||(t[19]=l("td",{class:"print-only"},null,-1))])}),128))])])])]),_:1}))}});export{$e as default};
