import{Q as z,d as Z}from"./dayjs.min-DOpdMjxR.js";import{r as w,e as B,o as G,a as c,f as S,g as n,h as l,u as J,Z as X,i as N,t as d,d as C,b as t,n as _,Q as m,k as v,l as p,c as j,F as ee,j as te,N as L,v as se,y as le,A as re}from"./app-B9dkpGLK.js";import{Q as E,a as T}from"./format-D7GaRK-I.js";import{Q as ne}from"./QLayout-CjwSdPgF.js";import{Q as de}from"./QMenu-wN6hlZOM.js";import{Q as oe}from"./QPage-zxMC9aqx.js";import{_ as ue}from"./AdminLayout-BNQZF6Hu.js";import"./QExpansionItem-sevoPI2F.js";import"./ClosePopup-Bydqmf8k.js";const ae={class:"q-my-md grid grid-cols-1 md:grid-cols-2 gap-4"},ce={class:"flex flex-col sm:flex-row gap-2"},me={class:"flex justify-end"},ve={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fe={key:0,class:"flex"},ie={class:"flex justify-end pr-16"},be={ref:"printSection",class:"rounded-lg overflow-x-auto table-responsive"},he={class:"q-table q-table__grid q-mb-lg"},ge={key:0},ye=["value"],Ae={class:"no-print"},Ie=Object.assign({layout:ue},{__name:"BillPayment",props:{applications:Array,flash:Object},setup(b){const Q=b;w(null);const F=w([]),u=w(""),i=w("All"),o=w([]),V=B(()=>o.value.length>0),$=r=>Z(r).format("dddd, MMMM D, YYYY h:mm A");G(()=>{const r=[...new Set(Q.applications.map(s=>s.deceased.district.name))];F.value=r.map(s=>({label:s,value:s}))});const k=B(()=>{let r=Q.applications;return i.value!=="All"&&(r=r.filter(s=>s.status===i.value)),u.value&&(r=r.filter(s=>{var e,a,f,h,g,y,A,x;return((e=s.application_no)==null?void 0:e.toString().includes(u.value))||((f=(a=s.deceased)==null?void 0:a.name)==null?void 0:f.toLowerCase().includes(u.value.toLowerCase()))||((g=(h=s.applicant)==null?void 0:h.name)==null?void 0:g.toLowerCase().includes(u.value.toLowerCase()))||((x=(A=(y=s.deceased)==null?void 0:y.district)==null?void 0:A.name)==null?void 0:x.toLowerCase().includes(u.value.toLowerCase()))})),r}),P=r=>{i.value=r},R=r=>{L.get(route("bill.show",r))},U=r=>{console.log("Delete application:",r)},H=()=>{o.value.length===k.value.length?o.value=[]:o.value=k.value.map(r=>r.id)},Y=async()=>{if(o.value.length>0)try{await L.post("/admin/bill/paymet-all",{ids:o.value},{onSuccess:()=>{o.value=[]}})}catch(r){console.error("Error processing payments:",r)}},K=async()=>{if(o.value.length>0)try{await L.post("/admin/bill/reject-all",{ids:o.value},{onSuccess:()=>{o.value=[]}})}catch(r){console.error("Error rejecting applications:",r)}},W=()=>{const s=document.querySelector(".q-table").cloneNode(!0);s.querySelectorAll(".no-print").forEach(f=>f.remove());const a=window.open("","","width=800,height=600");a.document.write(`
        <html>
            <head>
                <title>Print Table</title>
                <style>
                    table {
                        width: 100%;
                        border-collapse: collapse;
                    }
                    th, td {
                        padding: 8px 12px;
                        text-align: left;
                        border-bottom: 1px solid #ddd;
                    }
                    th {
                        background-color: #3A424A;
                        color: white;
                        font-weight: bold;
                    }
                </style>
            </head>
            <body>
                ${s.outerHTML}
            </body>
        </html>
    `),a.document.close(),a.print()};return(r,s)=>(c(),S(oe,{padding:""},{default:n(()=>[l(J(X),{title:"Bills"}),b.flash.success?(c(),S(z,{key:0,class:"bg-green-4 text-white",dense:""},{default:n(()=>[N(d(b.flash.success),1)]),_:1})):C("",!0),b.flash.error?(c(),S(z,{key:1,class:"bg-red-4 text-white",dense:""},{default:n(()=>[N(d(b.flash.error),1)]),_:1})):C("",!0),t("div",ae,[t("div",ce,[l(m,{size:"",label:"Bill Pek tur",flat:"",class:_(i.value==="Approved"?"active-button":"inactive-button"),onClick:s[0]||(s[0]=e=>P("Approved"))},null,8,["class"]),l(m,{label:"Deposit to Bank",flat:"",class:_(i.value==="Processed"?"active-button":"inactive-button"),onClick:s[1]||(s[1]=e=>P("Processed"))},null,8,["class"]),l(m,{label:"Rejected",flat:"",class:_(i.value==="Rejected"?"active-button":"inactive-button"),onClick:s[2]||(s[2]=e=>P("Rejected"))},null,8,["class"])]),t("div",me,[l(p,{color:"dark",rounded:"2lg",outlined:"",dense:"","bottom-slots":"",modelValue:u.value,"onUpdate:modelValue":s[4]||(s[4]=e=>u.value=e),label:"Search",class:"w-full max-w-md"},{append:n(()=>[u.value!==""?(c(),S(v,{key:0,name:"close",onClick:s[3]||(s[3]=e=>u.value=""),class:"cursor-pointer"})):C("",!0),l(v,{name:"search"})]),_:1},8,["modelValue"])])]),s[14]||(s[14]=t("hr",{class:"my-4 border-border bg-[#F0F0F0]"},null,-1)),t("div",ve,[t("div",null,[V.value?(c(),j("div",fe,[l(m,{style:{"border-radius":"8px"},size:"md",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center hover:bg-[#3A424A] hover:text-white",onClick:H},{default:n(()=>[l(v,{name:"check",size:"16px",class:"q-mr-xs"}),s[6]||(s[6]=t("span",null,"Select All",-1))]),_:1}),l(m,{style:{"border-radius":"8px"},size:"md",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center hover:bg-[#3A424A] hover:text-white",onClick:Y,disabled:!o.value.length},{default:n(()=>[l(v,{name:"check_circle",size:"16px",class:"q-mr-xs"}),s[7]||(s[7]=t("span",null,"Process for Deposit",-1))]),_:1},8,["disabled"]),l(m,{style:{"border-radius":"8px"},size:"md",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center hover:bg-[#3A424A] hover:text-white",onClick:K,disabled:!o.value.length},{default:n(()=>[l(v,{name:"cancel",size:"16px",class:"q-mr-xs"}),s[8]||(s[8]=t("span",null,"Reject",-1))]),_:1},8,["disabled"])])):C("",!0)]),t("div",ie,[l(m,{size:"sm",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",style:{color:"#000",width:"100px",height:"40px","flex-shrink":"0","border-radius":"8px",background:"transparent"},onClick:W},{default:n(()=>[l(v,{name:"print",size:"16px",class:"q-mr-xs"}),s[9]||(s[9]=t("span",null,"Print",-1))]),_:1})])]),t("div",be,[t("table",he,[s[13]||(s[13]=t("thead",{class:"bg-[#3A424A] text-white font-bold h-[30px] w-full text-[11px]"},[t("tr",{class:"bg-[#3A424A] text-white"},[t("th"),t("th",null,"Sl.No."),t("th",null,"APPLICATION NO."),t("th",null,"APPLICANT NAME"),t("th",null,"ADDRESS"),t("th",null,"CONTACT No."),t("th",null,"MITTHI KHUA"),t("th",null,"PLACE OF DEATH"),t("th",null,"KILOMETER"),t("th",null,"AMOUNT CLAIMED"),t("th",null,"ACCOUNT No. OF CLAIMANT"),t("th",null,"IFSC"),t("th",null,"STATUS"),t("th",null,"DIL NI"),t("th",{class:"no-print"},"ACTIONS"),t("th",{class:"print-only"},"Signature")])],-1)),k.value.length?(c(),j("tbody",ge,[(c(!0),j(ee,null,te(k.value,(e,a)=>{var f,h,g,y,A,x,q,D,M,O;return c(),j("tr",{key:e.id},[t("td",null,[se(t("input",{class:"no-print",type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=I=>o.value=I),value:e.id},null,8,ye),[[le,o.value]])]),t("td",null,d(a+1),1),t("td",null,d(e==null?void 0:e.application_no),1),t("td",null,d((f=e==null?void 0:e.applicant)==null?void 0:f.name),1),t("td",null,d((h=e==null?void 0:e.applicant)==null?void 0:h.locality),1),t("td",null,d((g=e==null?void 0:e.applicant)==null?void 0:g.mobile),1),t("td",null,d((A=(y=e==null?void 0:e.deceased)==null?void 0:y.district)==null?void 0:A.name),1),t("td",null,d((x=e==null?void 0:e.deceased)==null?void 0:x.place_of_death),1),t("td",null,d((q=e==null?void 0:e.transport)==null?void 0:q.distance),1),t("td",null,d((D=e==null?void 0:e.transport)==null?void 0:D.transport_cost),1),t("td",null,d((M=e==null?void 0:e.applicant)==null?void 0:M.account_no),1),t("td",null,d((O=e==null?void 0:e.applicant)==null?void 0:O.ifsc_code),1),t("td",null,[t("div",{class:_([{"status-incoming":(e==null?void 0:e.status)==="Pending","status-rejected":(e==null?void 0:e.status)==="Rejected","status-approved":(e==null?void 0:e.status)==="Approved","status-paid":(e==null?void 0:e.status)==="Processed"},"status-badge"])},d(e==null?void 0:e.status),3)]),t("td",null,d($(e==null?void 0:e.created_at)),1),t("td",Ae,[l(m,{flat:"",icon:"more_vert",style:re(r.buttonStyle)},null,8,["style"]),l(de,null,{default:n(()=>[l(ne,null,{default:n(()=>[l(E,{clickable:"",class:"action-btn",onClick:I=>R(e.id)},{default:n(()=>[l(T,{avatar:""},{default:n(()=>[l(v,{size:"sm",name:"visibility"})]),_:1}),l(T,null,{default:n(()=>s[10]||(s[10]=[N("View")])),_:1})]),_:2},1032,["onClick"]),l(E,{clickable:"",class:"action-btn",onClick:I=>U(e.id)},{default:n(()=>[l(T,{avatar:""},{default:n(()=>[l(v,{name:"delete"})]),_:1}),l(T,null,{default:n(()=>s[11]||(s[11]=[N("Delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),s[12]||(s[12]=t("td",{class:"print-only"},null,-1))])}),128))])):C("",!0)])],512)]),_:1}))}});export{Ie as default};
