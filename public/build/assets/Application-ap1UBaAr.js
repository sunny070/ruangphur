import{Q as U,u as T,w as ee,d as te}from"./dayjs.min-C_2x_JPx.js";import{r as g,c as _,o as se,a as i,b as w,w as o,d as A,t as a,e as j,f as s,g as y,h as z,F as P,i as n,n as x,Q as u,j as v,k as le,N as F,s as ne,v as oe,A as re}from"./app-C0In1_Bg.js";import{Q as ae}from"./QSelect-BYJrp-GI.js";import{Q as S,a as V}from"./format-DY5QUvbx.js";import{Q as de}from"./QLayout-DRIoFCNj.js";import{Q as ue}from"./QMenu-DPumZ7aG.js";import{Q as ie}from"./QPage-D75BcEeD.js";import{_ as ce}from"./AdminLayout-zIaWW83l.js";import"./QChip-DR_ehPOn.js";import"./rtl-DFPa-2ov.js";import"./QExpansionItem-CzGHoK9d.js";import"./ClosePopup-CPzUbm6V.js";const me={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4"},fe={class:"text-sm sm:text-base font-bold"},ve={class:"text-xs sm:text-sm"},be={class:"q-my-md grid grid-cols-1 md:grid-cols-2 gap-4"},ge={class:"q-my-md flex gap-16"},xe={class:"flex justify-end"},Ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ae={key:0,class:"flex"},ye={class:"flex justify-end pr-16"},ke={class:"table-responsive"},Ie={class:"q-table q-table__grid q-mb-lg"},he=["value"],Oe=Object.assign({layout:ce},{__name:"Application",props:{applications:Array,statusCounts:Object,flash:Object},setup(C){const c=C,k=g(null),D=g([]),f=g(""),m=g("All"),r=g([]),N=g(!1),R=l=>te(l).format("dddd, MMMM D, YYYY h:mm A"),$=_(()=>r.value.length>0),H=()=>{r.value.length===b.value.length?(r.value=[],N.value=!1):(r.value=b.value.map(l=>l.id),N.value=!0)},B=()=>{k.value?b.value=c.applications.filter(l=>l.deceased.district.name===k.value):b.value=c.applications};se(()=>{const l=[...new Set(c.applications.map(t=>t.deceased.district.name))];D.value=l.map(t=>({label:t,value:t}))});const b=_(()=>{let l=c.applications;return m.value==="Incoming"?l=l.filter(t=>t.status==="Pending"):m.value==="Verified"?l=l.filter(t=>t.status==="Verified"):m.value==="Rejected"&&(l=l.filter(t=>t.status==="Rejected")),f.value&&(l=l.filter(t=>t.application_no.toString().includes(f.value)||t.deceased.name.toLowerCase().includes(f.value.toLowerCase()))),l}),I=l=>{m.value=l},K=async()=>{if(r.value.length>0)try{await F.post("/verifier/applications/verify-all",{ids:r.value},{onSuccess:()=>{r.value=[]}})}catch(l){console.error("Error approving applications:",l)}},Y=async()=>{if(r.value.length>0)try{await F.post("/verifier/applications/reject-all",{ids:r.value},{onSuccess:()=>{r.value=[]}})}catch(l){console.error("Error rejecting applications:",l)}},G=l=>{F.get(route("applications.show",l))},J=l=>{console.log("Edit application:",l)},W=l=>{console.log("Delete application:",l)},X=()=>{window.print()},Z=()=>{const l=b.value.map(d=>({"APPLICANT ID":d.application_no,"MITTHI HMING":d.deceased.name,"MITTHI KHUA":d.deceased.district.name,KILOMETER:d.transport.distance,AMOUNT:d.transport.transport_cost,"DIL SAKTU":d.applicant.name,"DILTU PHONE NO":d.applicant.mobile,STATUS:d.status,"DIL NI":d.created_at})),t=T.json_to_sheet(l),e=T.book_new();T.book_append_sheet(e,t,"Applications"),ee(e,"applications.xlsx")},p=_(()=>[{label:"Incoming",count:c.statusCounts.Incoming||0,bgClass:"bg-[#FFF7EF]",textClass:"text-[#FD7900]"},{label:"Verified",count:c.statusCounts.Verified||0,bgClass:"bg-[#EEFFF8]",textClass:"text-[#00AA68]"},{label:"Rejected",count:c.statusCounts.Rejected||0,bgClass:"bg-[#FFF2F2]",textClass:"text-[#FE6262]"},{label:"Pending",count:c.statusCounts.Pending||0,bgClass:"bg-[#F2F8FF]",textClass:"text-[#404CF1]"}]);return(l,t)=>(i(),w(ie,{padding:""},{default:o(()=>[C.flash.success?(i(),w(U,{key:0,class:"bg-green-4 text-white",dense:""},{default:o(()=>[A(a(C.flash.success),1)]),_:1})):j("",!0),C.flash.error?(i(),w(U,{key:1,class:"bg-red-4 text-white",dense:""},{default:o(()=>[A(a(C.flash.error),1)]),_:1})):j("",!0),s("div",me,[(i(!0),y(P,null,z(p.value,e=>(i(),y("div",{key:e.label,class:x(`w-full h-[78px] ${e.bgClass} ${e.textClass} text-center`)},[s("h6",fe,a(e.count),1),s("p",ve,a(e.label),1)],2))),128))]),s("div",be,[s("div",ge,[n(u,{label:"All",flat:"",class:x(m.value==="All"?"active-button":"inactive-button"),onClick:t[0]||(t[0]=e=>I("All"))},null,8,["class"]),n(u,{label:"Incoming",flat:"",class:x(m.value==="Incoming"?"active-button":"inactive-button"),onClick:t[1]||(t[1]=e=>I("Incoming"))},null,8,["class"]),n(u,{label:"Verified",flat:"",class:x(m.value==="Verified"?"active-button":"inactive-button"),onClick:t[2]||(t[2]=e=>I("Verified"))},null,8,["class"]),n(u,{label:"Rejected",flat:"",class:x(m.value==="Rejected"?"active-button":"inactive-button"),onClick:t[3]||(t[3]=e=>I("Rejected"))},null,8,["class"])]),s("div",xe,[n(le,{rounded:"lg",outlined:"",dense:"","bottom-slots":"",modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=e=>f.value=e),label:"Search",class:"w-full max-w-md"},{append:o(()=>[f.value!==""?(i(),w(v,{key:0,name:"close",onClick:t[4]||(t[4]=e=>f.value=""),class:"cursor-pointer"})):j("",!0),n(v,{name:"search"})]),_:1},8,["modelValue"])])]),s("div",Ce,[s("div",null,[$.value?(i(),y("div",Ae,[n(u,{style:{"border-radius":"8px"},size:"md",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:H},{default:o(()=>[n(v,{name:"check",size:"16px",class:"q-mr-xs"}),t[8]||(t[8]=s("span",null,"Select All",-1))]),_:1}),n(u,{style:{"border-radius":"8px"},size:"md",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:K,disabled:!r.value.length},{default:o(()=>[n(v,{name:"check_circle",size:"16px",class:"q-mr-xs"}),t[9]||(t[9]=s("span",null,"Verify All",-1))]),_:1},8,["disabled"]),n(u,{style:{"border-radius":"8px"},size:"md",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:Y,disabled:!r.value.length},{default:o(()=>[n(v,{name:"cancel",size:"16px",class:"q-mr-xs"}),t[10]||(t[10]=s("span",null,"Reject All",-1))]),_:1},8,["disabled"])])):j("",!0)]),s("div",ye,[n(u,{size:"sm",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:X},{default:o(()=>[n(v,{name:"print",size:"16px",class:"q-mr-xs"}),t[11]||(t[11]=s("span",null,"Print",-1))]),_:1}),n(u,{size:"sm",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:Z},{default:o(()=>[n(v,{name:"ios_share",size:"16px",class:"q-mr-xs"}),t[12]||(t[12]=s("span",null,"Export",-1))]),_:1}),n(ae,{style:{color:"#000",width:"128px",height:"40px","flex-shrink":"0","border-radius":"8px",border:"1px solid black",background:"transparent"},modelValue:k.value,"onUpdate:modelValue":t[6]||(t[6]=e=>k.value=e),options:D.value,label:"Select District",outlined:"",dense:"",class:"q-mb-md",onInput:B},null,8,["modelValue","options"])])]),s("div",ke,[s("table",Ie,[t[16]||(t[16]=s("thead",{class:"bg-[#3A424A] text-white font-bold h-[30px] w-full text-[11px]"},[s("tr",null,[s("th"),s("th",null,"APPLICANT ID"),s("th",null,"MITTHI HMING"),s("th",null,"MITTHI KHUA"),s("th",null,"KILOMETER"),s("th",null,"AMOUNT"),s("th",null,"DIL SAKTU"),s("th",null,"DILTU PHONE NO"),s("th",null,"STATUS"),s("th",null,"DIL NI"),s("th",null,"ACTIONS")])],-1)),s("tbody",null,[(i(!0),y(P,null,z(b.value,e=>{var d,Q,M,q,E,O,L;return i(),y("tr",{key:e.id},[s("td",null,[ne(s("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=h=>r.value=h),value:e.id},null,8,he),[[oe,r.value]])]),s("td",null,a(e==null?void 0:e.application_no),1),s("td",null,a((d=e==null?void 0:e.deceased)==null?void 0:d.name),1),s("td",null,a((M=(Q=e==null?void 0:e.deceased)==null?void 0:Q.district)==null?void 0:M.name),1),s("td",null,a((q=e==null?void 0:e.transport)==null?void 0:q.distance),1),s("td",null,a((E=e==null?void 0:e.transport)==null?void 0:E.transport_cost),1),s("td",null,a((O=e==null?void 0:e.applicant)==null?void 0:O.name),1),s("td",null,a((L=e==null?void 0:e.applicant)==null?void 0:L.mobile),1),s("td",null,[s("div",{class:x([{"status-incoming":(e==null?void 0:e.status)==="Pending","status-rejected":(e==null?void 0:e.status)==="Rejected","status-approved":(e==null?void 0:e.status)==="Verified"},"status-badge"])},a(e==null?void 0:e.status),3)]),s("td",null,a(R(e==null?void 0:e.created_at)),1),s("td",null,[n(u,{flat:"",icon:"more_vert",style:re(l.buttonStyle)},null,8,["style"]),n(ue,null,{default:o(()=>[n(de,null,{default:o(()=>[n(S,{clickable:"",class:"action-btn",onClick:h=>G(e.id)},{default:o(()=>[n(V,null,{default:o(()=>t[13]||(t[13]=[A("View")])),_:1})]),_:2},1032,["onClick"]),n(S,{class:"action-btn",onClick:h=>J(e.id)},{default:o(()=>[n(V,null,{default:o(()=>t[14]||(t[14]=[A("Edit/Update")])),_:1})]),_:2},1032,["onClick"]),n(S,{class:"action-btn",onClick:h=>W(e.id)},{default:o(()=>[n(V,null,{default:o(()=>t[15]||(t[15]=[A("Delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)])])}),128))])])])]),_:1}))}});export{Oe as default};
