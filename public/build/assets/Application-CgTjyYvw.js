import{Q as B,d as de,u as _,w as re}from"./dayjs.min-DiKvzL0t.js";import{r as C,c as F,e as ue,o as a,a as v,b as o,f as m,t as u,d as y,g as l,h as k,i as K,n as A,F as Y,j as n,Q as c,k as g,l as ae,m as ie,v as ce,p as me,N as D}from"./app-DE0G_PcF.js";import{Q as N}from"./QTooltip-BxxKNGZP.js";import{Q as fe}from"./QSelect-BwW1F_A4.js";import{Q as V,a as E}from"./format--TUUW8L8.js";import{Q as ve}from"./QLayout-CVDZaGjc.js";import{Q as be}from"./QMenu-D_oUq42q.js";import{Q as ge}from"./QPage-5AzggwAy.js";import{_ as xe}from"./AdminLayout-CzjlYrQF.js";import"./QChip-CiUjFxzV.js";import"./rtl-DFPa-2ov.js";import"./QExpansionItem-CbgYRtL_.js";import"./ClosePopup-zl1a1MWy.js";const Ce={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4"},ye={class:"text-sm sm:text-base font-bold"},Ae={class:"text-xs sm:text-sm"},he={class:"q-my-md grid grid-cols-1 md:grid-cols-2 gap-4"},ke={class:"q-my-md flex gap-16"},Ie={class:"flex justify-end"},we={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Te={key:0,class:"flex"},Se={class:"flex justify-end pr-16"},je={class:"table-responsive"},Fe={class:"q-table q-table__grid q-mb-lg"},Ne=["value"],_e={class:"no-print"},Be=Object.assign({layout:xe},{__name:"Application",props:{applications:Array,statusCounts:Object,flash:Object},setup(h){const i=h,I=C(null),P=C([]),b=C(""),f=C("All"),d=C([]),Q=C(!1),G=s=>de(s).format("dddd, MMMM D, YYYY h:mm A"),W=F(()=>d.value.length>0),w=F(()=>d.value.some(s=>{const t=i.applications.find(e=>e.id===s);return(t==null?void 0:t.status)==="Pending"})),J=()=>{d.value.length===x.value.length?(d.value=[],Q.value=!1):(d.value=x.value.map(s=>s.id),Q.value=!0)},X=()=>{I.value?x.value=i.applications.filter(s=>s.deceased.district.name===I.value):x.value=i.applications};ue(()=>{const s=[...new Set(i.applications.map(t=>t.deceased.district.name))];P.value=s.map(t=>({label:t,value:t}))});const x=F(()=>{let s=i.applications;return f.value==="Incoming"?s=s.filter(t=>t.status==="Pending"):f.value==="Verified"?s=s.filter(t=>t.status==="Verified"):f.value==="Rejected"&&(s=s.filter(t=>t.status==="Rejected")),b.value&&(s=s.filter(t=>t.application_no.toString().includes(b.value)||t.deceased.name.toLowerCase().includes(b.value.toLowerCase()))),s}),T=s=>{f.value=s},Z=async()=>{const s=d.value.filter(t=>{const e=i.applications.find(r=>r.id===t);return(e==null?void 0:e.status)==="Pending"});s.length!==0&&await D.post("/verifier/applications/verify-all",{ids:s})},p=async()=>{if(d.value.length>0)try{await D.post("/verifier/applications/reject-all",{ids:d.value},{onSuccess:()=>{d.value=[]}})}catch(s){console.error("Error rejecting applications:",s)}},ee=s=>{D.get(route("verifier.applications.show",s))},te=s=>{console.log("Edit application:",s)},le=s=>{console.log("Delete application:",s)},se=()=>{const t=document.querySelector(".q-table").cloneNode(!0);t.querySelectorAll(".no-print").forEach(S=>S.remove());const r=window.open("","","width=800,height=600");r.document.write(`
        <html>
            <head>
                <title>Print Table</title>
                <style>
                    table {
                        width: 100%;
                        border-collapse: collapse;
                    }
                    th, td {
                        padding: 8px 12px;
                        text-align: left;
                        border-bottom: 1px solid #ddd;
                    }
                    th {
                        background-color: #3A424A;
                        color: white;
                        font-weight: bold;
                    }
                </style>
            </head>
            <body>
                ${t.outerHTML}
            </body>
        </html>
    `),r.document.close(),r.print()},ne=()=>{const s=x.value.map(r=>({"APPLICANT ID":r.application_no,"MITTHI HMING":r.deceased.name,"MITTHI KHUA":r.deceased.district.name,KILOMETER:r.transport.distance,AMOUNT:r.transport.transport_cost,"DIL SAKTU":r.applicant.name,"DILTU PHONE NO":r.applicant.mobile,STATUS:r.status,"DIL NI":r.created_at})),t=_.json_to_sheet(s),e=_.book_new();_.book_append_sheet(e,t,"Applications"),re(e,"applications.xlsx")},oe=F(()=>[{label:"Incoming",count:i.statusCounts.Incoming||0,bgClass:"bg-[#FFF7EF]",textClass:"text-[#FD7900]"},{label:"Verified",count:i.statusCounts.Verified||0,bgClass:"bg-[#EEFFF8]",textClass:"text-[#00AA68]"},{label:"Rejected",count:i.statusCounts.Rejected||0,bgClass:"bg-[#FFF2F2]",textClass:"text-[#FE6262]"},{label:"Pending",count:i.statusCounts.Pending||0,bgClass:"bg-[#F2F8FF]",textClass:"text-[#404CF1]"}]);return(s,t)=>(a(),v(ge,{padding:""},{default:o(()=>[h.flash.success?(a(),v(B,{key:0,class:"bg-green-4 text-white",dense:""},{default:o(()=>[m(u(h.flash.success),1)]),_:1})):y("",!0),h.flash.error?(a(),v(B,{key:1,class:"bg-red-4 text-white",dense:""},{default:o(()=>[m(u(h.flash.error),1)]),_:1})):y("",!0),l("div",Ce,[(a(!0),k(Y,null,K(oe.value,e=>(a(),k("div",{key:e.label,class:A(`w-full h-[78px] ${e.bgClass} ${e.textClass} text-center`)},[l("h6",ye,u(e.count),1),l("p",Ae,u(e.label),1)],2))),128))]),l("div",he,[l("div",ke,[n(c,{label:"All",flat:"",class:A(f.value==="All"?"active-button":"inactive-button"),onClick:t[0]||(t[0]=e=>T("All"))},null,8,["class"]),n(c,{label:"Incoming",flat:"",class:A(f.value==="Incoming"?"active-button":"inactive-button"),onClick:t[1]||(t[1]=e=>T("Incoming"))},null,8,["class"]),n(c,{label:"Verified",flat:"",class:A(f.value==="Verified"?"active-button":"inactive-button"),onClick:t[2]||(t[2]=e=>T("Verified"))},null,8,["class"]),n(c,{label:"Rejected",flat:"",class:A(f.value==="Rejected"?"active-button":"inactive-button"),onClick:t[3]||(t[3]=e=>T("Rejected"))},null,8,["class"])]),l("div",Ie,[n(ae,{rounded:"lg",outlined:"",dense:"","bottom-slots":"",modelValue:b.value,"onUpdate:modelValue":t[5]||(t[5]=e=>b.value=e),label:"Search",class:"w-full max-w-md"},{append:o(()=>[b.value!==""?(a(),v(g,{key:0,name:"close",onClick:t[4]||(t[4]=e=>b.value=""),class:"cursor-pointer"})):y("",!0),n(g,{name:"search"})]),_:1},8,["modelValue"])])]),l("div",we,[l("div",null,[W.value?(a(),k("div",Te,[n(c,{style:{"border-radius":"8px"},size:"md",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:J},{default:o(()=>[n(g,{name:"check",size:"16px",class:"q-mr-xs"}),t[8]||(t[8]=l("span",null,"Select All",-1))]),_:1}),n(c,{style:{"border-radius":"8px"},size:"md",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:Z,disabled:!d.value.length||!w.value},{default:o(()=>[n(g,{name:"check_circle",size:"16px",class:"q-mr-xs"}),t[11]||(t[11]=l("span",null,"Verify All",-1)),!w.value&&d.value.length?(a(),v(N,{key:0},{default:o(()=>t[9]||(t[9]=[m(" Cannot verify - selected applications are already processed ")])),_:1})):d.value.length?y("",!0):(a(),v(N,{key:1},{default:o(()=>t[10]||(t[10]=[m(" Select applications to verify ")])),_:1}))]),_:1},8,["disabled"]),n(c,{style:{"border-radius":"8px"},size:"md",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:p,disabled:!d.value.length||!w.value},{default:o(()=>[n(g,{name:"cancel",size:"16px",class:"q-mr-xs"}),t[14]||(t[14]=l("span",null,"Reject All",-1)),!w.value&&d.value.length?(a(),v(N,{key:0},{default:o(()=>t[12]||(t[12]=[m(" Cannot Reject - selected applications are already processed ")])),_:1})):d.value.length?y("",!0):(a(),v(N,{key:1},{default:o(()=>t[13]||(t[13]=[m(" Select applications to verify ")])),_:1}))]),_:1},8,["disabled"])])):y("",!0)]),l("div",Se,[n(c,{size:"sm",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:se},{default:o(()=>[n(g,{name:"print",size:"16px",class:"q-mr-xs"}),t[15]||(t[15]=l("span",null,"Print",-1))]),_:1}),n(c,{size:"sm",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",onClick:ne},{default:o(()=>[n(g,{name:"ios_share",size:"16px",class:"q-mr-xs"}),t[16]||(t[16]=l("span",null,"Export",-1))]),_:1}),n(fe,{style:{color:"#000",width:"128px",height:"40px","flex-shrink":"0","border-radius":"8px",border:"1px solid black",background:"transparent"},modelValue:I.value,"onUpdate:modelValue":t[6]||(t[6]=e=>I.value=e),options:P.value,label:"Select District",outlined:"",dense:"",class:"q-mb-md",onInput:X},null,8,["modelValue","options"])])]),l("div",je,[l("table",Fe,[t[21]||(t[21]=l("thead",{class:"bg-[#3A424A] text-white font-bold h-[30px] w-full text-[11px]"},[l("tr",null,[l("th",{class:"no_print"}),l("th",null,"Sl.No."),l("th",null,"APPLICATION NO."),l("th",null,"APPLICANT NAME"),l("th",null,"ADDRESS"),l("th",null,"CONTACT No."),l("th",null,"MITTHI KHUA"),l("th",null,"PLACE OF DEATH"),l("th",null,"KILOMETER"),l("th",null,"AMOUNT CLAIMED"),l("th",null,"ACCOUNT No. OF CLAIMANT"),l("th",null,"IFSC"),l("th",null,"STATUS"),l("th",null,"DIL NI"),l("th",{class:"no-print"},"ACTIONS"),l("th",{class:"print-only"},"Signature")])],-1)),l("tbody",null,[(a(!0),k(Y,null,K(x.value,(e,r)=>{var S,q,M,O,L,R,U,z,$,H;return a(),k("tr",{key:e.id},[l("td",null,[ie(l("input",{class:"no-print",type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=j=>d.value=j),value:e.id},null,8,Ne),[[ce,d.value]])]),l("td",null,u(r+1),1),l("td",null,u(e==null?void 0:e.application_no),1),l("td",null,u((S=e==null?void 0:e.applicant)==null?void 0:S.name),1),l("td",null,u((q=e==null?void 0:e.applicant)==null?void 0:q.locality),1),l("td",null,u((M=e==null?void 0:e.applicant)==null?void 0:M.mobile),1),l("td",null,u((L=(O=e==null?void 0:e.deceased)==null?void 0:O.district)==null?void 0:L.name),1),l("td",null,u((R=e==null?void 0:e.deceased)==null?void 0:R.place_of_death),1),l("td",null,u((U=e==null?void 0:e.transport)==null?void 0:U.distance),1),l("td",null,u((z=e==null?void 0:e.transport)==null?void 0:z.transport_cost),1),l("td",null,u(($=e==null?void 0:e.applicant)==null?void 0:$.account_no),1),l("td",null,u((H=e==null?void 0:e.applicant)==null?void 0:H.ifsc_code),1),l("td",null,[l("div",{class:A([{"status-incoming":(e==null?void 0:e.status)==="Pending","status-rejected":(e==null?void 0:e.status)==="Rejected","status-approved":(e==null?void 0:e.status)==="Verified"},"status-badge"])},u(e==null?void 0:e.status),3)]),l("td",null,u(G(e==null?void 0:e.created_at)),1),l("td",_e,[n(c,{flat:"",icon:"more_vert",style:me(s.buttonStyle)},null,8,["style"]),n(be,null,{default:o(()=>[n(ve,null,{default:o(()=>[n(V,{clickable:"",class:"action-btn",onClick:j=>ee(e.id)},{default:o(()=>[n(E,null,{default:o(()=>t[17]||(t[17]=[m("View")])),_:1})]),_:2},1032,["onClick"]),n(V,{class:"action-btn",onClick:j=>te(e.id)},{default:o(()=>[n(E,null,{default:o(()=>t[18]||(t[18]=[m("Edit/Update")])),_:1})]),_:2},1032,["onClick"]),n(V,{class:"action-btn",onClick:j=>le(e.id)},{default:o(()=>[n(E,null,{default:o(()=>t[19]||(t[19]=[m("Delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),t[20]||(t[20]=l("td",{class:"print-only"},null,-1))])}),128))])])])]),_:1}))}});export{Be as default};
