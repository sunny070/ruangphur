import{Q as W,d as Ve}from"./dayjs.min-DFIUUdL8.js";import{r as m,c as q,o as ye,a as i,b as V,w as d,d as s,u as xe,Z as Ce,e as h,t as r,f,g as o,h as g,i as Z,F as G,Q as k,j as n,k as y,l as J,m as X,n as ke,p as ee,q as le,s as te,N as S,v as se}from"./app-BHeael7A.js";import{Q as A}from"./QSelect-DDZxhFw8.js";import{Q as N,a as w}from"./format-CYKmJ8Oj.js";import{Q as Ae}from"./QLayout-7wX7CmRM.js";import{Q as we}from"./QMenu-aFYmALZq.js";import{Q as he}from"./QForm-DV-5sO98.js";import{Q as Ue}from"./QPage-DO6UowWf.js";import{C as oe}from"./ClosePopup-B8Woq_MJ.js";import{_ as qe}from"./AdminLayout-BPkz0efM.js";import{T as Fe}from"./TransportRouteMap-DxvVzeZH.js";import"./QChip-DfmNLKZN.js";import"./rtl-DFPa-2ov.js";import"./QExpansionItem-OPCk_GRv.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Se={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4"},Ne={class:"text-sm sm:text-base font-black"},Ie={class:"text-xs sm:text-sm"},Pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Te={class:""},De={class:"flex justify-end pr-16"},Ee={ref:"printSection",class:"rounded-lg overflow-x-auto table-responsive"},Qe={class:"q-table q-table__grid w-full"},Le={key:0},Me={class:"no-print"},_e={key:1},Re={key:0},je={key:1},Oe={class:"mt-4",style:{height:"200px"}},$e={key:2},al=Object.assign({layout:qe},{__name:"Application",props:{applications:Array,statusCounts:Object,flash:Object,dropdowns:Object},setup(c){const b=c,ae=a=>Ve(a).format("dddd, MMMM D, YYYY h:mm A"),U=m(!1),I=m(!1);m(null);const P=m(null),T=m(null),de=m(null),v=m(1),t=m({deceased:{},transport:{},applicant:{}});q(()=>Q.value.some(a=>{const l=b.applications.find(u=>u.id===a);return l&&l.status!=="Pending"&&l.status!=="Verified"}));const ne=a=>{var l,u,p,e;t.value={...a,transport:{...a.transport,source_lat:Number((l=a.transport)==null?void 0:l.source_lat)||23.1645,source_lng:Number((u=a.transport)==null?void 0:u.source_lng)||92.9376,destination_lat:Number((p=a.transport)==null?void 0:p.destination_lat)||23.1645,destination_lng:Number((e=a.transport)==null?void 0:e.destination_lng)||92.9376}},v.value=1,U.value=!0},ue=()=>{if(de.value){alert("Please fix route errors before submitting");return}S.put(`/application/${t.value.id}`,t.value,{onSuccess:()=>{U.value=!1}})},re=()=>{v.value<4&&v.value++},ie=()=>{v.value>1&&v.value--},D=m([]),x=m(null),E=m([]),C=m(""),F=m("All"),Q=m([]);q(()=>Q.value.length>0),m(!1);const me=()=>{x.value?D.value=b.applications.filter(a=>a.deceased.district.name===x.value):D.value=b.applications},ve=()=>{nextTick(()=>{const a=P.value.$el.querySelector("input"),l=T.value.$el.querySelector("input");new google.maps.places.Autocomplete(a,{types:["geocode"]}).addListener("place_changed",()=>{const u=autocomplete.getPlace();t.value.transport.source_locality=u.formatted_address}),new google.maps.places.Autocomplete(l,{types:["geocode"]}).addListener("place_changed",()=>{const u=autocomplete.getPlace();t.value.transport.destination_locality=u.formatted_address})})};ye(()=>{const a=[...new Set(b.applications.map(l=>l.deceased.district.name))];E.value=a.map(l=>({label:l,value:l}))});const L=q(()=>{let a=b.applications;if(x.value&&(a=a.filter(l=>l.deceased.district.name===x.value)),F.value==="Incoming"?a=a.filter(l=>l.status==="Pending"):F.value==="Approved"?a=a.filter(l=>l.status==="Approved"):F.value==="Rejected"&&(a=a.filter(l=>l.status==="Rejected")),C.value){const l=C.value.toLowerCase();a=a.filter(u=>u.application_no.toString().toLowerCase().includes(l)||u.applicant.name.toLowerCase().includes(l)||u.deceased.name.toLowerCase().includes(l)||u.applicant.mobile.toString().includes(l)||u.deceased.district.name.toLowerCase().includes(l))}return a}),ce=a=>{S.get(route("applications.show",a))},be=()=>{const l=document.querySelector(".q-table").cloneNode(!0);l.querySelectorAll(".no-print").forEach(e=>e.remove());const p=window.open("","","width=800,height=600");p.document.write(`
        <html>
            <head>
                <title>Print Table</title>
                <style>
                    table {
                        width: 100%;
                        border-collapse: collapse;
                    }
                    th, td {
                        padding: 8px 12px;
                        text-align: left;
                        border-bottom: 1px solid #ddd;
                    }
                    th {
                        background-color: #3A424A;
                        color: white;
                        font-weight: bold;
                    }
                </style>
            </head>
            <body>
                ${l.outerHTML}
            </body>
        </html>
    `),p.document.close(),p.print()},pe=q(()=>[{label:"Incoming",count:b.statusCounts.Incoming||0,bgClass:"bg-[#FFF7EF]",textClass:"text-[#FD7900]"},{label:"Approved",count:b.statusCounts.Approved||0,bgClass:"bg-[#EEFFF8]",textClass:"text-[#00AA68]"},{label:"Rejected",count:b.statusCounts.Rejected||0,bgClass:"bg-[#FFF2F2]",textClass:"text-[#FE6262]"},{label:"Pending",count:b.statusCounts.Pending||0,bgClass:"bg-[#F2F8FF]",textClass:"text-[#404CF1]"},{label:"Processed",count:b.statusCounts.Processed||0,bgClass:"bg-[#F2FBFF]",textClass:"text-[#00AEFF]"}]),fe=a=>{confirm("Are you sure you want to delete this application?")&&S.delete(`/applications/${a}`,{onSuccess:()=>{}})};return(a,l)=>(i(),V(Ue,{padding:""},{default:d(()=>{var u,p;return[s(xe(Ce),{title:"Application"}),(u=c.flash)!=null&&u.success?(i(),V(W,{key:0,class:"bg-green-4 text-white",dense:""},{default:d(()=>[h(r(c.flash.success),1)]),_:1})):f("",!0),(p=c.flash)!=null&&p.error?(i(),V(W,{key:1,class:"bg-red-4 text-white",dense:""},{default:d(()=>[h(r(c.flash.error),1)]),_:1})):f("",!0),o("div",Se,[(i(!0),g(G,null,Z(pe.value,e=>(i(),g("div",{key:e.label,class:se(`w-full h-[78px] ${e.bgClass} ${e.textClass} p-4`)},[o("h6",Ne,r(e.count),1),o("p",Ie,r(e.label),1)],2))),128))]),l[43]||(l[43]=o("div",{class:"q-my-md grid grid-cols-1 md:grid-cols-2 gap-4"},null,-1)),o("div",Pe,[o("div",Te,[s(n,{rounded:"lg",outlined:"",dense:"","bottom-slots":"",modelValue:C.value,"onUpdate:modelValue":l[1]||(l[1]=e=>C.value=e),label:"Search",color:"dark",class:"w-full max-w-md"},{append:d(()=>[C.value!==""?(i(),V(k,{key:0,name:"close",onClick:l[0]||(l[0]=e=>C.value=""),class:"cursor-pointer"})):f("",!0),s(k,{name:"search"})]),_:1},8,["modelValue"])]),o("div",De,[s(y,{size:"sm",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",style:{color:"#000",width:"100px",height:"40px","border-radius":"8px"},onClick:be},{default:d(()=>[s(k,{name:"print",size:"16px",class:"q-mr-xs"}),l[33]||(l[33]=o("span",null,"Print",-1))]),_:1}),s(A,{color:"dark",style:{color:"#000",width:"160px",height:"40px","flex-shrink":"0","border-radius":"8px",border:"1px solid black",background:"transparent"},modelValue:x.value,"onUpdate:modelValue":l[2]||(l[2]=e=>x.value=e),options:E.value,label:"Select District",outlined:"",dense:"",class:"q-mb-md",onInput:me},null,8,["modelValue","options"])])]),o("div",Ee,[o("table",Qe,[l[39]||(l[39]=o("thead",null,[o("tr",{class:"bg-[#3A424A] text-white"},[o("th",null,"Sl.No."),o("th",null,"APPLICATION NO."),o("th",null,"APPLICANT NAME"),o("th",null,"ADDRESS"),o("th",null,"CONTACT No."),o("th",null,"MITTHI KHUA"),o("th",null,"PLACE OF DEATH"),o("th",null,"KILOMETER"),o("th",null,"AMOUNT CLAIMED"),o("th",null,"ACCOUNT No. OF CLAIMANT"),o("th",null,"IFSC"),o("th",null,"STATUS"),o("th",null,"DIL NI"),o("th",{class:"no-print"},"ACTIONS"),o("th",{class:"print-only"},"Signature")])],-1)),L.value.length?(i(),g("tbody",Le,[(i(!0),g(G,null,Z(L.value,(e,ge)=>{var M,_,R,j,O,$,B,z,H,Y;return i(),g("tr",{key:e.id},[o("td",null,r(ge+1),1),o("td",null,r(e==null?void 0:e.application_no),1),o("td",null,r((M=e==null?void 0:e.applicant)==null?void 0:M.name),1),o("td",null,r((_=e==null?void 0:e.applicant)==null?void 0:_.locality),1),o("td",null,r((R=e==null?void 0:e.applicant)==null?void 0:R.mobile),1),o("td",null,r((O=(j=e==null?void 0:e.deceased)==null?void 0:j.district)==null?void 0:O.name),1),o("td",null,r(($=e==null?void 0:e.deceased)==null?void 0:$.place_of_death),1),o("td",null,r((B=e==null?void 0:e.transport)==null?void 0:B.distance),1),o("td",null,r((z=e==null?void 0:e.transport)==null?void 0:z.transport_cost),1),o("td",null,r((H=e==null?void 0:e.applicant)==null?void 0:H.account_no),1),o("td",null,r((Y=e==null?void 0:e.applicant)==null?void 0:Y.ifsc_code),1),o("td",null,[o("div",{class:se([{"status-incoming":(e==null?void 0:e.status)==="Pending","status-verified":(e==null?void 0:e.status)==="Verified","status-rejected":(e==null?void 0:e.status)==="Rejected","status-approved":(e==null?void 0:e.status)==="Approved","status-paid":(e==null?void 0:e.status)==="Processed"},"status-badge"])},r(e==null?void 0:e.status),3)]),o("td",null,r(ae(e==null?void 0:e.created_at)),1),o("td",Me,[s(y,{flat:"",icon:"more_vert"}),s(we,null,{default:d(()=>[s(Ae,null,{default:d(()=>[s(N,{clickable:"",onClick:K=>ce(e.id)},{default:d(()=>[s(w,{avatar:""},{default:d(()=>[s(k,{size:"sm",name:"visibility"})]),_:1}),s(w,null,{default:d(()=>l[34]||(l[34]=[h("View")])),_:1})]),_:2},1032,["onClick"]),s(N,{clickable:"",onClick:K=>ne(e)},{default:d(()=>[s(w,{avatar:""},{default:d(()=>[s(k,{name:"edit"})]),_:1}),s(w,null,{default:d(()=>l[35]||(l[35]=[h("Edit/Update")])),_:1})]),_:2},1032,["onClick"]),s(N,{clickable:"",onClick:K=>fe(e.id)},{default:d(()=>[s(w,{avatar:""},{default:d(()=>[s(k,{name:"delete"})]),_:1}),s(w,null,{default:d(()=>l[36]||(l[36]=[h("Delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),l[37]||(l[37]=o("td",{class:"print-only"},null,-1))])}),128))])):(i(),g("tbody",_e,l[38]||(l[38]=[o("tr",null,[o("td",{colspan:"11",class:"text-center text-gray-500"}," No applications found. ")],-1)])))])],512),s(te,{modelValue:U.value,"onUpdate:modelValue":l[31]||(l[31]=e=>U.value=e)},{default:d(()=>[s(J,{class:"w-[411px] h-[822px] rounded-md"},{default:d(()=>[s(X,null,{default:d(()=>[s(he,{onSubmit:ke(ue,["prevent"])},{default:d(()=>[v.value===1?(i(),g("div",Re,[l[40]||(l[40]=o("p",{class:"text-center w-[242px] h-[17px] flex-shrink-0 rounded-[20px] bg-[#E9E9E9] mb-8"}," Ruang Phurh MITTHI Chungchang ",-1)),s(n,{modelValue:t.value.deceased.name,"onUpdate:modelValue":l[3]||(l[3]=e=>t.value.deceased.name=e),label:"Mitthi hming",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(n,{modelValue:t.value.deceased.relative_name,"onUpdate:modelValue":l[4]||(l[4]=e=>t.value.deceased.relative_name=e),label:"A chhungte hming",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(n,{type:"date",modelValue:t.value.deceased.dob,"onUpdate:modelValue":l[5]||(l[5]=e=>t.value.deceased.dob=e),label:"Mitthi Pianni leh thla",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(A,{modelValue:t.value.deceased.district.name,"onUpdate:modelValue":l[6]||(l[6]=e=>t.value.deceased.district.name=e),options:c.dropdowns.districts,"option-label":"name","option-value":"id",label:"District",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue","options"]),s(n,{modelValue:t.value.deceased.locality,"onUpdate:modelValue":l[7]||(l[7]=e=>t.value.deceased.locality=e),label:"Locality",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(A,{modelValue:t.value.deceased.constituency.name,"onUpdate:modelValue":l[8]||(l[8]=e=>t.value.deceased.constituency.name=e),options:c.dropdowns.constituencies,"option-label":"name","option-value":"id",label:"Constituency",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue","options"]),s(n,{type:"datetime-local",modelValue:t.value.deceased.time_of_death,"onUpdate:modelValue":l[9]||(l[9]=e=>t.value.deceased.time_of_death=e),label:"Thih ni leh darkar",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(n,{modelValue:t.value.deceased.place_of_death,"onUpdate:modelValue":l[10]||(l[10]=e=>t.value.deceased.place_of_death=e),label:"Thihna hmun",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"])])):f("",!0),v.value===2?(i(),g("div",je,[l[41]||(l[41]=o("p",{class:"text-center w-[242px] h-[17px] flex-shrink-0 rounded-[20px] bg-[#E9E9E9] mb-8"}," Ruang Phurh leh Motor Chungchang ",-1)),s(A,{modelValue:t.value.transport.source_district,"onUpdate:modelValue":l[11]||(l[11]=e=>t.value.transport.source_district=e),options:c.dropdowns.districts,"option-label":"name","option-value":"id",label:"Ruang phurh tanna tur District awmna",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue","options"]),s(n,{ref_key:"sourceInput",ref:P,modelValue:t.value.transport.source_locality,"onUpdate:modelValue":l[12]||(l[12]=e=>t.value.transport.source_locality=e),label:"Source Locality",outlined:"",dense:""},null,8,["modelValue"]),s(A,{modelValue:t.value.transport.destination_district,"onUpdate:modelValue":l[13]||(l[13]=e=>t.value.transport.destination_district=e),options:c.dropdowns.districts,"option-label":"name","option-value":"id",label:"Ruang zalhna tur District awmna",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue","options"]),s(n,{ref_key:"destinationInput",ref:T,modelValue:t.value.transport.destination_locality,"onUpdate:modelValue":l[14]||(l[14]=e=>t.value.transport.destination_locality=e),label:"Destination Locality",outlined:"",dense:""},null,8,["modelValue"]),o("div",Oe,[s(Fe,{transport:t.value.transport,"onUpdate:sourceLocality":l[15]||(l[15]=e=>t.value.transport.source_locality=e),"onUpdate:destinationLocality":l[16]||(l[16]=e=>t.value.transport.destination_locality=e),"onUpdate:distance":l[17]||(l[17]=e=>t.value.transport.distance=e),"onUpdate:transportCost":l[18]||(l[18]=e=>t.value.transport.transport_cost=e),onMapsLoaded:ve},null,8,["transport"])]),s(n,{modelValue:t.value.transport.distance,"onUpdate:modelValue":l[19]||(l[19]=e=>t.value.transport.distance=e),label:"Distance (Km)",outlined:"",dense:"",class:"q-mb-md pt-[400px]"},null,8,["modelValue"]),s(n,{modelValue:t.value.transport.transport_cost,"onUpdate:modelValue":l[20]||(l[20]=e=>t.value.transport.transport_cost=e),label:"Transport Cost",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(n,{modelValue:t.value.transport.vehicle_number,"onUpdate:modelValue":l[21]||(l[21]=e=>t.value.transport.vehicle_number=e),label:"Vehicle Number",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(n,{modelValue:t.value.transport.driver_name,"onUpdate:modelValue":l[22]||(l[22]=e=>t.value.transport.driver_name=e),label:"Driver Name",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(n,{modelValue:t.value.transport.driver_phone,"onUpdate:modelValue":l[23]||(l[23]=e=>t.value.transport.driver_phone=e),label:"Driver Phone",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"])])):f("",!0),v.value===3?(i(),g("div",$e,[s(n,{modelValue:t.value.applicant.name,"onUpdate:modelValue":l[24]||(l[24]=e=>t.value.applicant.name=e),label:"Applicant Name",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(n,{modelValue:t.value.applicant.mobile,"onUpdate:modelValue":l[25]||(l[25]=e=>t.value.applicant.mobile=e),label:"Mobile",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(A,{modelValue:t.value.applicant.district.name,"onUpdate:modelValue":l[26]||(l[26]=e=>t.value.applicant.district.name=e),options:c.dropdowns.districts,"option-label":"name","option-value":"id",label:"Ruang phurhna man diltu district",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue","options"]),s(n,{modelValue:t.value.applicant.locality,"onUpdate:modelValue":l[27]||(l[27]=e=>t.value.applicant.locality=e),label:"Ruang phurhna man diltu veng/khua",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(n,{modelValue:t.value.applicant.bank_name,"onUpdate:modelValue":l[28]||(l[28]=e=>t.value.applicant.bank_name=e),label:"Bank hming",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(n,{modelValue:t.value.applicant.account_no,"onUpdate:modelValue":l[29]||(l[29]=e=>t.value.applicant.account_no=e),label:"Account No",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(n,{modelValue:t.value.applicant.ifsc_code,"onUpdate:modelValue":l[30]||(l[30]=e=>t.value.applicant.ifsc_code=e),label:"IFSC Code",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"])])):f("",!0),s(ee,{align:"right"},{default:d(()=>[le(s(y,{class:"text-black",color:"white",label:"Cancel"},null,512),[[oe]]),v.value>1?(i(),V(y,{key:0,label:"Previous",color:"grey",onClick:ie})):f("",!0),v.value<3?(i(),V(y,{key:1,label:"Next",color:"black",onClick:re})):f("",!0),v.value===3?(i(),V(y,{key:2,label:"Submit",color:"black",type:"submit"})):f("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(te,{modelValue:I.value,"onUpdate:modelValue":l[32]||(l[32]=e=>I.value=e),maximized:""},{default:d(()=>[s(J,null,{default:d(()=>[s(X,null,{default:d(()=>l[42]||(l[42]=[o("div",{class:"text-h6"},"Transport Route Map",-1)])),_:1}),s(ee,{align:"right"},{default:d(()=>[le(s(y,{flat:"",label:"Close",color:"primary"},null,512),[[oe]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]}),_:1}))}});export{al as default};
