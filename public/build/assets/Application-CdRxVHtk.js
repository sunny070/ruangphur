import{Q as H,d as pe}from"./dayjs.min-Oy0eqcQE.js";import{r as m,c as q,o as fe,a as i,b as V,w as n,d as s,u as ge,Z as Ve,e as w,t as r,f as p,g as o,h as f,i as Y,F as K,Q as C,j as u,k as x,l as W,m as Z,n as xe,p as G,q as J,s as X,N as S,v as ee}from"./app-DYJu_hh0.js";import{Q as k}from"./QSelect-CIjIcnhz.js";import{Q as F,a as h}from"./format-DPTxXwLs.js";import{Q as ye}from"./QLayout-DKyBKObu.js";import{Q as Ce}from"./QMenu-BHGL6jif.js";import{Q as ke}from"./QForm-BeoM8mMx.js";import{Q as he}from"./QPage-D1RYuMuC.js";import{C as le}from"./ClosePopup-CfCC9Cj8.js";import{_ as we}from"./AdminLayout-BxM4lzZW.js";import{T as Ae}from"./TransportRouteMap-Cz960Yrd.js";import"./QChip-BvGp2FJD.js";import"./rtl-DFPa-2ov.js";import"./QExpansionItem-C9_T0O2J.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ue={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4"},qe={class:"text-sm sm:text-base font-black"},Se={class:"text-xs sm:text-sm"},Fe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ne={class:""},Ie={class:"flex justify-end pr-16"},Te={ref:"printSection",class:"rounded-lg overflow-x-auto table-responsive"},Pe={class:"q-table q-table__grid w-full"},De={key:0},Ee={class:"no-print"},Qe={key:1},Le={key:0},Me={key:1},_e={class:"mt-4",style:{height:"200px"}},Oe={key:2},tl=Object.assign({layout:we},{__name:"Application",props:{applications:Array,statusCounts:Object,flash:Object,dropdowns:Object},setup(c){const g=c,te=d=>pe(d).format("dddd, MMMM D, YYYY h:mm A"),A=m(!1),N=m(!1);m(null);const I=m(null),T=m(null),se=m(null),v=m(1),t=m({deceased:{},transport:{},applicant:{}});q(()=>ue.value.some(d=>{const l=g.applications.find(a=>a.id===d);return l&&l.status!=="Pending"&&l.status!=="Verified"}));const oe=d=>{var l,a,b,e;t.value={...d,transport:{...d.transport,source_lat:Number((l=d.transport)==null?void 0:l.source_lat)||23.1645,source_lng:Number((a=d.transport)==null?void 0:a.source_lng)||92.9376,destination_lat:Number((b=d.transport)==null?void 0:b.destination_lat)||23.1645,destination_lng:Number((e=d.transport)==null?void 0:e.destination_lng)||92.9376}},v.value=1,A.value=!0},de=()=>{if(se.value){alert("Please fix route errors before submitting");return}S.put(`/application/${t.value.id}`,t.value,{onSuccess:()=>{A.value=!1}})},ne=()=>{v.value<4&&v.value++},ae=()=>{v.value>1&&v.value--};m([]);const U=m(null),P=m([]),y=m("");m("All");const ue=m([]),re=()=>{nextTick(()=>{const d=I.value.$el.querySelector("input"),l=T.value.$el.querySelector("input");new google.maps.places.Autocomplete(d,{types:["geocode"]}).addListener("place_changed",()=>{const a=autocomplete.getPlace();t.value.transport.source_locality=a.formatted_address}),new google.maps.places.Autocomplete(l,{types:["geocode"]}).addListener("place_changed",()=>{const a=autocomplete.getPlace();t.value.transport.destination_locality=a.formatted_address})})};fe(()=>{const d=[...new Set(g.applications.map(l=>l.deceased.district.name))];P.value=d.map(l=>({label:l,value:l}))});const D=q(()=>{let d=g.applications;if(U.value&&(d=d.filter(l=>{var a,b,e;return((b=(a=l==null?void 0:l.deceased)==null?void 0:a.district)==null?void 0:b.name)===((e=U.value)==null?void 0:e.value)})),y.value){const l=y.value.toLowerCase();d=d.filter(a=>a.application_no.toString().toLowerCase().includes(l)||a.applicant.name.toLowerCase().includes(l)||a.deceased.name.toLowerCase().includes(l)||a.applicant.mobile.toString().includes(l)||a.deceased.district.name.toLowerCase().includes(l))}return d}),ie=d=>{S.get(route("applications.show",d))},me=()=>{const l=document.querySelector(".q-table").cloneNode(!0);l.querySelectorAll(".no-print").forEach(e=>e.remove());const b=window.open("","","width=800,height=600");b.document.write(`
        <html>
            <head>
                <title>Print Table</title>
                <style>
                    table {
                        width: 100%;
                        border-collapse: collapse;
                    }
                    th, td {
                        padding: 8px 12px;
                        text-align: left;
                        border-bottom: 1px solid #ddd;
                    }
                    th {
                        background-color: #3A424A;
                        color: white;
                        font-weight: bold;
                    }
                </style>
            </head>
            <body>
                ${l.outerHTML}
            </body>
        </html>
    `),b.document.close(),b.print()},be=q(()=>[{label:"Incoming",count:g.statusCounts.Incoming||0,bgClass:"bg-[#FFF7EF]",textClass:"text-[#FD7900]"},{label:"Approved",count:g.statusCounts.Approved||0,bgClass:"bg-[#EEFFF8]",textClass:"text-[#00AA68]"},{label:"Rejected",count:g.statusCounts.Rejected||0,bgClass:"bg-[#FFF2F2]",textClass:"text-[#FE6262]"},{label:"Pending",count:g.statusCounts.Pending||0,bgClass:"bg-[#F2F8FF]",textClass:"text-[#404CF1]"},{label:"Processed",count:g.statusCounts.Processed||0,bgClass:"bg-[#F2FBFF]",textClass:"text-[#00AEFF]"}]),ve=d=>{confirm("Are you sure you want to delete this application?")&&S.delete(`/applications/${d}`,{onSuccess:()=>{}})};return(d,l)=>(i(),V(he,{padding:""},{default:n(()=>{var a,b;return[s(ge(Ve),{title:"Application"}),(a=c.flash)!=null&&a.success?(i(),V(H,{key:0,class:"bg-green-4 text-white",dense:""},{default:n(()=>[w(r(c.flash.success),1)]),_:1})):p("",!0),(b=c.flash)!=null&&b.error?(i(),V(H,{key:1,class:"bg-red-4 text-white",dense:""},{default:n(()=>[w(r(c.flash.error),1)]),_:1})):p("",!0),o("div",Ue,[(i(!0),f(K,null,Y(be.value,e=>(i(),f("div",{key:e.label,class:ee(`w-full h-[78px] ${e.bgClass} ${e.textClass} p-4`)},[o("h6",qe,r(e.count),1),o("p",Se,r(e.label),1)],2))),128))]),l[43]||(l[43]=o("div",{class:"q-my-md grid grid-cols-1 md:grid-cols-2 gap-4"},null,-1)),o("div",Fe,[o("div",Ne,[s(u,{rounded:"lg",outlined:"",dense:"","bottom-slots":"",modelValue:y.value,"onUpdate:modelValue":l[1]||(l[1]=e=>y.value=e),label:"Search",color:"dark",class:"w-full max-w-md"},{append:n(()=>[y.value!==""?(i(),V(C,{key:0,name:"close",onClick:l[0]||(l[0]=e=>y.value=""),class:"cursor-pointer"})):p("",!0),s(C,{name:"search"})]),_:1},8,["modelValue"])]),o("div",Ie,[s(x,{size:"sm",flat:"",outlined:"",class:"q-btn-custom flex items-center justify-center",style:{color:"#000",width:"100px",height:"40px","border-radius":"8px"},onClick:me},{default:n(()=>[s(C,{name:"print",size:"16px",class:"q-mr-xs"}),l[33]||(l[33]=o("span",null,"Print",-1))]),_:1}),s(k,{color:"dark",style:{color:"#000",width:"160px",height:"40px","flex-shrink":"0","border-radius":"8px",border:"1px solid black",background:"transparent"},modelValue:U.value,"onUpdate:modelValue":l[2]||(l[2]=e=>U.value=e),options:P.value,"option-value":"value","option-label":"label",label:"Select District",outlined:"",dense:"",class:"q-mb-md",onInput:d.filterByDistrict},null,8,["modelValue","options","onInput"])])]),o("div",Te,[o("table",Pe,[l[39]||(l[39]=o("thead",null,[o("tr",{class:"bg-[#3A424A] text-white"},[o("th",null,"Sl.No."),o("th",null,"APPLICATION NO."),o("th",null,"APPLICANT NAME"),o("th",null,"ADDRESS"),o("th",null,"CONTACT No."),o("th",null,"MITTHI KHUA"),o("th",null,"PLACE OF DEATH"),o("th",null,"KILOMETER"),o("th",null,"AMOUNT CLAIMED"),o("th",null,"ACCOUNT No. OF CLAIMANT"),o("th",null,"IFSC"),o("th",null,"STATUS"),o("th",null,"DIL NI"),o("th",{class:"no-print"},"ACTIONS"),o("th",{class:"print-only"},"Signature")])],-1)),D.value.length?(i(),f("tbody",De,[(i(!0),f(K,null,Y(D.value,(e,ce)=>{var E,Q,L,M,_,O,R,j,$,B;return i(),f("tr",{key:e.id},[o("td",null,r(ce+1),1),o("td",null,r(e==null?void 0:e.application_no),1),o("td",null,r((E=e==null?void 0:e.applicant)==null?void 0:E.name),1),o("td",null,r((Q=e==null?void 0:e.applicant)==null?void 0:Q.locality),1),o("td",null,r((L=e==null?void 0:e.applicant)==null?void 0:L.mobile),1),o("td",null,r((_=(M=e==null?void 0:e.deceased)==null?void 0:M.district)==null?void 0:_.name),1),o("td",null,r((O=e==null?void 0:e.deceased)==null?void 0:O.place_of_death),1),o("td",null,r((R=e==null?void 0:e.transport)==null?void 0:R.distance),1),o("td",null,r((j=e==null?void 0:e.transport)==null?void 0:j.transport_cost),1),o("td",null,r(($=e==null?void 0:e.applicant)==null?void 0:$.account_no),1),o("td",null,r((B=e==null?void 0:e.applicant)==null?void 0:B.ifsc_code),1),o("td",null,[o("div",{class:ee([{"status-incoming":(e==null?void 0:e.status)==="Pending","status-verified":(e==null?void 0:e.status)==="Verified","status-rejected":(e==null?void 0:e.status)==="Rejected","status-approved":(e==null?void 0:e.status)==="Approved","status-paid":(e==null?void 0:e.status)==="Processed"},"status-badge"])},r(e==null?void 0:e.status),3)]),o("td",null,r(te(e==null?void 0:e.created_at)),1),o("td",Ee,[s(x,{flat:"",icon:"more_vert"}),s(Ce,null,{default:n(()=>[s(ye,null,{default:n(()=>[s(F,{clickable:"",onClick:z=>ie(e.id)},{default:n(()=>[s(h,{avatar:""},{default:n(()=>[s(C,{size:"sm",name:"visibility"})]),_:1}),s(h,null,{default:n(()=>l[34]||(l[34]=[w("View")])),_:1})]),_:2},1032,["onClick"]),s(F,{clickable:"",onClick:z=>oe(e)},{default:n(()=>[s(h,{avatar:""},{default:n(()=>[s(C,{name:"edit"})]),_:1}),s(h,null,{default:n(()=>l[35]||(l[35]=[w("Edit/Update")])),_:1})]),_:2},1032,["onClick"]),s(F,{clickable:"",onClick:z=>ve(e.id)},{default:n(()=>[s(h,{avatar:""},{default:n(()=>[s(C,{name:"delete"})]),_:1}),s(h,null,{default:n(()=>l[36]||(l[36]=[w("Delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),l[37]||(l[37]=o("td",{class:"print-only"},null,-1))])}),128))])):(i(),f("tbody",Qe,l[38]||(l[38]=[o("tr",null,[o("td",{colspan:"11",class:"text-center text-gray-500"}," No applications found. ")],-1)])))])],512),s(X,{modelValue:A.value,"onUpdate:modelValue":l[31]||(l[31]=e=>A.value=e)},{default:n(()=>[s(W,{class:"w-[411px] h-[822px] rounded-md"},{default:n(()=>[s(Z,null,{default:n(()=>[s(ke,{onSubmit:xe(de,["prevent"])},{default:n(()=>[v.value===1?(i(),f("div",Le,[l[40]||(l[40]=o("p",{class:"text-center w-[242px] h-[17px] flex-shrink-0 rounded-[20px] bg-[#E9E9E9] mb-8"}," Ruang Phurh MITTHI Chungchang ",-1)),s(u,{modelValue:t.value.deceased.name,"onUpdate:modelValue":l[3]||(l[3]=e=>t.value.deceased.name=e),label:"Mitthi hming",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(u,{modelValue:t.value.deceased.relative_name,"onUpdate:modelValue":l[4]||(l[4]=e=>t.value.deceased.relative_name=e),label:"A chhungte hming",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(u,{type:"date",modelValue:t.value.deceased.dob,"onUpdate:modelValue":l[5]||(l[5]=e=>t.value.deceased.dob=e),label:"Mitthi Pianni leh thla",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(k,{modelValue:t.value.deceased.district.name,"onUpdate:modelValue":l[6]||(l[6]=e=>t.value.deceased.district.name=e),options:c.dropdowns.districts,"option-label":"name","option-value":"id",label:"District",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue","options"]),s(u,{modelValue:t.value.deceased.locality,"onUpdate:modelValue":l[7]||(l[7]=e=>t.value.deceased.locality=e),label:"Locality",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(k,{modelValue:t.value.deceased.constituency.name,"onUpdate:modelValue":l[8]||(l[8]=e=>t.value.deceased.constituency.name=e),options:c.dropdowns.constituencies,"option-label":"name","option-value":"id",label:"Constituency",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue","options"]),s(u,{type:"datetime-local",modelValue:t.value.deceased.time_of_death,"onUpdate:modelValue":l[9]||(l[9]=e=>t.value.deceased.time_of_death=e),label:"Thih ni leh darkar",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(u,{modelValue:t.value.deceased.place_of_death,"onUpdate:modelValue":l[10]||(l[10]=e=>t.value.deceased.place_of_death=e),label:"Thihna hmun",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"])])):p("",!0),v.value===2?(i(),f("div",Me,[l[41]||(l[41]=o("p",{class:"text-center w-[242px] h-[17px] flex-shrink-0 rounded-[20px] bg-[#E9E9E9] mb-8"}," Ruang Phurh leh Motor Chungchang ",-1)),s(k,{modelValue:t.value.transport.source_district,"onUpdate:modelValue":l[11]||(l[11]=e=>t.value.transport.source_district=e),options:c.dropdowns.districts,"option-label":"name","option-value":"id",label:"Ruang phurh tanna tur District awmna",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue","options"]),s(u,{ref_key:"sourceInput",ref:I,modelValue:t.value.transport.source_locality,"onUpdate:modelValue":l[12]||(l[12]=e=>t.value.transport.source_locality=e),label:"Source Locality",outlined:"",dense:""},null,8,["modelValue"]),s(k,{modelValue:t.value.transport.destination_district,"onUpdate:modelValue":l[13]||(l[13]=e=>t.value.transport.destination_district=e),options:c.dropdowns.districts,"option-label":"name","option-value":"id",label:"Ruang zalhna tur District awmna",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue","options"]),s(u,{ref_key:"destinationInput",ref:T,modelValue:t.value.transport.destination_locality,"onUpdate:modelValue":l[14]||(l[14]=e=>t.value.transport.destination_locality=e),label:"Destination Locality",outlined:"",dense:""},null,8,["modelValue"]),o("div",_e,[s(Ae,{transport:t.value.transport,"onUpdate:sourceLocality":l[15]||(l[15]=e=>t.value.transport.source_locality=e),"onUpdate:destinationLocality":l[16]||(l[16]=e=>t.value.transport.destination_locality=e),"onUpdate:distance":l[17]||(l[17]=e=>t.value.transport.distance=e),"onUpdate:transportCost":l[18]||(l[18]=e=>t.value.transport.transport_cost=e),onMapsLoaded:re},null,8,["transport"])]),s(u,{modelValue:t.value.transport.distance,"onUpdate:modelValue":l[19]||(l[19]=e=>t.value.transport.distance=e),label:"Distance (Km)",outlined:"",dense:"",class:"q-mb-md pt-[400px]"},null,8,["modelValue"]),s(u,{modelValue:t.value.transport.transport_cost,"onUpdate:modelValue":l[20]||(l[20]=e=>t.value.transport.transport_cost=e),label:"Transport Cost",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(u,{modelValue:t.value.transport.vehicle_number,"onUpdate:modelValue":l[21]||(l[21]=e=>t.value.transport.vehicle_number=e),label:"Vehicle Number",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(u,{modelValue:t.value.transport.driver_name,"onUpdate:modelValue":l[22]||(l[22]=e=>t.value.transport.driver_name=e),label:"Driver Name",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(u,{modelValue:t.value.transport.driver_phone,"onUpdate:modelValue":l[23]||(l[23]=e=>t.value.transport.driver_phone=e),label:"Driver Phone",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"])])):p("",!0),v.value===3?(i(),f("div",Oe,[s(u,{modelValue:t.value.applicant.name,"onUpdate:modelValue":l[24]||(l[24]=e=>t.value.applicant.name=e),label:"Applicant Name",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(u,{modelValue:t.value.applicant.mobile,"onUpdate:modelValue":l[25]||(l[25]=e=>t.value.applicant.mobile=e),label:"Mobile",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(k,{modelValue:t.value.applicant.district.name,"onUpdate:modelValue":l[26]||(l[26]=e=>t.value.applicant.district.name=e),options:c.dropdowns.districts,"option-label":"name","option-value":"id",label:"Ruang phurhna man diltu district",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue","options"]),s(u,{modelValue:t.value.applicant.locality,"onUpdate:modelValue":l[27]||(l[27]=e=>t.value.applicant.locality=e),label:"Ruang phurhna man diltu veng/khua",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(u,{modelValue:t.value.applicant.bank_name,"onUpdate:modelValue":l[28]||(l[28]=e=>t.value.applicant.bank_name=e),label:"Bank hming",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(u,{modelValue:t.value.applicant.account_no,"onUpdate:modelValue":l[29]||(l[29]=e=>t.value.applicant.account_no=e),label:"Account No",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"]),s(u,{modelValue:t.value.applicant.ifsc_code,"onUpdate:modelValue":l[30]||(l[30]=e=>t.value.applicant.ifsc_code=e),label:"IFSC Code",outlined:"",dense:"",class:"q-mb-md"},null,8,["modelValue"])])):p("",!0),s(G,{align:"right"},{default:n(()=>[J(s(x,{style:{"border-radius":"8px"},label:"Cancel",color:"negative",onClick:d.confirmRejection},null,8,["onClick"]),[[le]]),v.value>1?(i(),V(x,{key:0,label:"Previous",style:{background:"transparent","border-radius":"8px",border:"1px solid #5b656f"},onClick:ae})):p("",!0),v.value<3?(i(),V(x,{key:1,label:"Next",size:"sm",style:{color:"#fff",width:"144px",height:"40px","flex-shrink":"0","border-radius":"8px",border:"1px solid #5b656f",background:"#000"},onClick:ne})):p("",!0),v.value===3?(i(),V(x,{key:2,label:"Submit",size:"sm",style:{color:"#fff",width:"144px",height:"40px","flex-shrink":"0","border-radius":"8px",border:"1px solid #5b656f",background:"#000"},type:"submit"})):p("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(X,{modelValue:N.value,"onUpdate:modelValue":l[32]||(l[32]=e=>N.value=e),maximized:""},{default:n(()=>[s(W,null,{default:n(()=>[s(Z,null,{default:n(()=>l[42]||(l[42]=[o("div",{class:"text-h6"},"Transport Route Map",-1)])),_:1}),s(G,{align:"right"},{default:n(()=>[J(s(x,{flat:"",label:"Close",color:"primary"},null,512),[[le]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]}),_:1}))}});export{tl as default};
